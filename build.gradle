buildscript {
  repositories {
    jcenter()
    maven { url "http://dl.bintray.com/spinnaker/gradle" }
  }
  dependencies {
    classpath 'com.netflix.spinnaker:spinnaker-gradle-project:1.12.115'
  }
}

group = "com.netflix.spinnaker.spinnaker"


apply plugin: 'application'
apply plugin: 'nebula.os-package'


ospackage {
  packageName = "${project.applicationName}"
  version = project.version.replaceAll("-SNAPSHOT", "")
  release '3'
  into "/opt/${project.applicationName}"
  from "."
}

buildDeb {
  requires('python-pip')
  requires('openjdk-8-jre', '8u45-b14-1~14.04', EQUAL)
  requires('cassandra', '2.1.9', EQUAL)
  requires('cassandra-tools', '2.1.9', EQUAL)
  requires('dsc21', '2.1.9-1', EQUAL)
  requires('redis-server', '3.0.5', GREATER | EQUAL)
  requires('clouddriver')
  requires('deck')
  requires('echo')
  requires('front50')
  requires('igor')
  requires('orca')
  requires('rosco')
  requires('rush')


  task redis_ppa(type: Exec) {
  executable "sh"
  args "-c", "echo 'deb http://ppa.launchpad.net/chris-lea/redis-server/ubuntu trusty main' > '/etc/apt/sources.list.d/chris-lea-redis-server.list'"
}

}

buildRpm {
  arch = NOARCH
  os = LINUX
}
